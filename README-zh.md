# Zokio

[![Zig ç‰ˆæœ¬](https://img.shields.io/badge/zig-0.14.0+-blue.svg)](https://ziglang.org/)
[![è®¸å¯è¯](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![æ„å»ºçŠ¶æ€](https://img.shields.io/badge/build-passing-brightgreen.svg)]()

**Zokio** æ˜¯ä¸€ä¸ªå……åˆ†å‘æŒ¥Zigè¯­è¨€ç‹¬ç‰¹ä¼˜åŠ¿çš„ä¸‹ä¸€ä»£å¼‚æ­¥è¿è¡Œæ—¶ã€‚é€šè¿‡ç¼–è¯‘æ—¶å…ƒç¼–ç¨‹ã€é›¶æˆæœ¬æŠ½è±¡å’Œæ˜¾å¼å†…å­˜ç®¡ç†ç­‰ç‰¹æ€§ï¼ŒZokioä½“ç°äº†"Zigå“²å­¦"ï¼Œåˆ›é€ äº†ä¸€ä¸ªçœŸæ­£åŸç”Ÿçš„é«˜æ€§èƒ½å¼‚æ­¥è¿è¡Œæ—¶ã€‚

[English Documentation](README.md) | [æ–‡æ¡£](docs/zh/README.md) | [ç¤ºä¾‹](examples/) | [åŸºå‡†æµ‹è¯•](benchmarks/)

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### ç¼–è¯‘æ—¶ä¼˜åŒ–
- **ç¼–è¯‘æ—¶å¼‚æ­¥çŠ¶æ€æœºç”Ÿæˆ**: æ‰€æœ‰async/awaitæ„é€ åœ¨ç¼–è¯‘æ—¶è½¬æ¢ä¸ºä¼˜åŒ–çš„çŠ¶æ€æœº
- **é›¶æˆæœ¬æŠ½è±¡**: æ‰€æœ‰æŠ½è±¡åœ¨ç¼–è¯‘åå®Œå…¨æ¶ˆå¤±ï¼Œæ— è¿è¡Œæ—¶å¼€é”€
- **ç¼–è¯‘æ—¶é…ç½®**: è¿è¡Œæ—¶è¡Œä¸ºåœ¨ç¼–è¯‘æ—¶ç¡®å®šå’Œä¼˜åŒ–

### é«˜æ€§èƒ½
- **å·¥ä½œçªƒå–è°ƒåº¦å™¨**: å…·æœ‰å·¥ä½œçªƒå–èƒ½åŠ›çš„å¤šçº¿ç¨‹ä»»åŠ¡è°ƒåº¦å™¨
- **é«˜æ€§èƒ½I/O**: æ”¯æŒLinuxä¸Šçš„io_uringã€macOS/BSDä¸Šçš„kqueueå’ŒWindowsä¸Šçš„IOCP
- **NUMAæ„ŸçŸ¥å†…å­˜ç®¡ç†**: é’ˆå¯¹NUMAæ¶æ„ä¼˜åŒ–çš„å†…å­˜åˆ†é…
- **SIMDä¼˜åŒ–**: åœ¨é€‚ç”¨çš„åœ°æ–¹ä½¿ç”¨å‘é‡åŒ–æ“ä½œ

### å†…å­˜å®‰å…¨
- **æ— åƒåœ¾å›æ”¶å™¨**: æ˜¾å¼å†…å­˜ç®¡ç†ï¼Œæ— GCå¼€é”€
- **ç¼–è¯‘æ—¶å†…å­˜å®‰å…¨**: åœ¨ç¼–è¯‘æ—¶ä¿è¯å†…å­˜å®‰å…¨
- **æ³„æ¼æ£€æµ‹**: åœ¨è°ƒè¯•æ„å»ºä¸­å†…ç½®å†…å­˜æ³„æ¼æ£€æµ‹

### è·¨å¹³å°
- **åŸç”Ÿå¹³å°æ”¯æŒ**: å¯¹æ‰€æœ‰Zigç›®æ ‡å¹³å°çš„ä¸€ç­‰æ”¯æŒ
- **å¹³å°ç‰¹å®šä¼˜åŒ–**: è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜I/Oåç«¯
- **ä¸€è‡´çš„API**: åœ¨æ‰€æœ‰æ”¯æŒçš„å¹³å°ä¸Šä½¿ç”¨ç›¸åŒçš„API

## ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•

åœ¨Apple M3 Proä¸Šçš„æœ€æ–°åŸºå‡†æµ‹è¯•ç»“æœï¼š

| ç»„ä»¶ | æ€§èƒ½ | ç›®æ ‡ | æˆå°± |
|------|------|------|------|
| ä»»åŠ¡è°ƒåº¦ | 4.51äº¿ ops/ç§’ | 500ä¸‡ ops/ç§’ | **å¿«90å€** |
| å·¥ä½œçªƒå–é˜Ÿåˆ— | 2.87äº¿ ops/ç§’ | 100ä¸‡ ops/ç§’ | **å¿«287å€** |
| Futureè½®è¯¢ | âˆ ops/ç§’ | 1000ä¸‡ ops/ç§’ | **æ— é™åˆ¶** |
| å†…å­˜åˆ†é… | 350ä¸‡ ops/ç§’ | 100ä¸‡ ops/ç§’ | **å¿«3.5å€** |
| å¯¹è±¡æ±  | 1.12äº¿ ops/ç§’ | 100ä¸‡ ops/ç§’ | **å¿«112å€** |
| åŸå­æ“ä½œ | 5.66äº¿ ops/ç§’ | 100ä¸‡ ops/ç§’ | **å¿«566å€** |
| I/Oæ“ä½œ | 6.32äº¿ ops/ç§’ | 100ä¸‡ ops/ç§’ | **å¿«632å€** |

### å‹åŠ›æµ‹è¯•ç»“æœ
- **é«˜å¹¶å‘**: 1äº¿ä»»åŠ¡/ç§’ï¼Œ100%æˆåŠŸç‡
- **ç½‘ç»œæ€§èƒ½**: 646 MB/så³°å€¼ååé‡ï¼Œ0%é”™è¯¯ç‡
- **å†…å­˜æ•ˆç‡**: 1.2GBå³°å€¼åˆ†é…ï¼Œé›¶æ³„æ¼

## ğŸ›  å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Zig 0.14.0æˆ–æ›´é«˜ç‰ˆæœ¬
- æ”¯æŒçš„å¹³å°ï¼šLinuxã€macOSã€Windowsã€BSD

### å®‰è£…

å°†Zokioæ·»åŠ åˆ°ä½ çš„`build.zig.zon`ï¼š

```zig
.{
    .name = "my-project",
    .version = "0.1.0",
    .dependencies = .{
        .zokio = .{
            .url = "https://github.com/louloulin/zokio/archive/main.tar.gz",
            .hash = "...",
        },
    },
}
```

### åŸºæœ¬ç”¨æ³•

```zig
const std = @import("std");
const zokio = @import("zokio");

// å®šä¹‰å¼‚æ­¥ä»»åŠ¡
const HelloTask = struct {
    message: []const u8,

    pub const Output = void;

    pub fn poll(self: *@This(), ctx: *zokio.Context) zokio.Poll(void) {
        _ = ctx;
        std.debug.print("å¼‚æ­¥ä»»åŠ¡: {s}\n", .{self.message});
        return .{ .ready = {} };
    }
};

pub fn main() !void {
    var gpa = std.heap.GeneralPurposeAllocator(.{}){};
    defer _ = gpa.deinit();
    const allocator = gpa.allocator();

    // é…ç½®è¿è¡Œæ—¶
    const config = zokio.RuntimeConfig{
        .worker_threads = 4,
        .enable_work_stealing = true,
        .enable_io_uring = true,
        .enable_metrics = true,
    };

    // åˆ›å»ºå¹¶å¯åŠ¨è¿è¡Œæ—¶
    const RuntimeType = zokio.ZokioRuntime(config);
    var runtime = try RuntimeType.init(allocator);
    defer runtime.deinit();

    try runtime.start();
    defer runtime.stop();

    // æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡
    const task = HelloTask{ .message = "ä½ å¥½ï¼ŒZokioï¼" };
    try runtime.blockOn(task);
}
```

## ğŸ— æ¶æ„

Zokioé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åº”ç”¨å±‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    é«˜çº§API                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   ç½‘ç»œI/O   â”‚ â”‚   æ–‡ä»¶ç³»ç»Ÿ  â”‚ â”‚     å®šæ—¶å™¨å’Œå»¶è¿Ÿ    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    è¿è¡Œæ—¶æ ¸å¿ƒ                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    è°ƒåº¦å™¨   â”‚ â”‚  I/Oé©±åŠ¨    â”‚ â”‚     å†…å­˜ç®¡ç†å™¨      â”‚ â”‚
â”‚  â”‚  (å·¥ä½œçªƒå–) â”‚ â”‚ (io_uring/  â”‚ â”‚   (NUMAæ„ŸçŸ¥)        â”‚ â”‚
â”‚  â”‚             â”‚ â”‚  kqueue)    â”‚ â”‚                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   FutureæŠ½è±¡                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Futureç‰¹å¾ â”‚ â”‚ Contextå’Œ   â”‚ â”‚       Waker         â”‚ â”‚
â”‚  â”‚             â”‚ â”‚    Poll     â”‚ â”‚                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   å¹³å°æŠ½è±¡                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    Linux    â”‚ â”‚    macOS    â”‚ â”‚      Windows        â”‚ â”‚
â”‚  â”‚ (io_uring)  â”‚ â”‚  (kqueue)   â”‚ â”‚       (IOCP)        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

1. **è¿è¡Œæ—¶æ ¸å¿ƒ**: ç¼–è¯‘æ—¶é…ç½®çš„è¿è¡Œæ—¶ï¼Œå…·æœ‰æœ€ä¼˜ç»„ä»¶é€‰æ‹©
2. **è°ƒåº¦å™¨**: å·¥ä½œçªƒå–å¤šçº¿ç¨‹ä»»åŠ¡è°ƒåº¦å™¨
3. **I/Oé©±åŠ¨**: å¹³å°ç‰¹å®šçš„é«˜æ€§èƒ½I/Oåç«¯
4. **å†…å­˜ç®¡ç†å™¨**: NUMAæ„ŸçŸ¥çš„å†…å­˜åˆ†é…å’Œç®¡ç†
5. **Futureç³»ç»Ÿ**: é›¶æˆæœ¬å¼‚æ­¥æŠ½è±¡
6. **åŒæ­¥åŸè¯­**: æ— é”åŒæ­¥åŸè¯­

## ğŸ“š æ–‡æ¡£

- [ä¸­æ–‡æ–‡æ¡£](docs/zh/)
  - [å¿«é€Ÿå¼€å§‹](docs/zh/getting-started.md)
  - [APIå‚è€ƒ](docs/zh/api-reference.md)
  - [æ¶æ„æŒ‡å—](docs/zh/architecture.md)
  - [æ€§èƒ½æŒ‡å—](docs/zh/performance.md)
  - [ç¤ºä¾‹ä»£ç ](docs/zh/examples.md)

- [English Documentation](docs/en/)
  - [Getting Started](docs/en/getting-started.md)
  - [API Reference](docs/en/api-reference.md)
  - [Architecture Guide](docs/en/architecture.md)
  - [Performance Guide](docs/en/performance.md)
  - [Examples](docs/en/examples.md)

## ğŸ§ª ç¤ºä¾‹

æ¢ç´¢æˆ‘ä»¬çš„ç»¼åˆç¤ºä¾‹ï¼š

- [Hello World](examples/hello_world.zig) - åŸºæœ¬å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œ
- [TCPå›æ˜¾æœåŠ¡å™¨](examples/tcp_echo_server.zig) - é«˜æ€§èƒ½TCPæœåŠ¡å™¨
- [HTTPæœåŠ¡å™¨](examples/http_server.zig) - å¼‚æ­¥HTTPæœåŠ¡å™¨å®ç°
- [æ–‡ä»¶å¤„ç†å™¨](examples/file_processor.zig) - å¼‚æ­¥æ–‡ä»¶I/Oæ“ä½œ

è¿è¡Œç¤ºä¾‹ï¼š
```bash
# æ„å»ºå¹¶è¿è¡Œhello worldç¤ºä¾‹
zig build example-hello_world

# æ„å»ºå¹¶è¿è¡ŒTCPå›æ˜¾æœåŠ¡å™¨
zig build example-tcp_echo_server

# æ„å»ºå¹¶è¿è¡ŒHTTPæœåŠ¡å™¨
zig build example-http_server

# æ„å»ºå¹¶è¿è¡Œæ–‡ä»¶å¤„ç†å™¨
zig build example-file_processor
```

## ğŸ”¬ åŸºå‡†æµ‹è¯•å’Œæµ‹è¯•

### è¿è¡ŒåŸºå‡†æµ‹è¯•
```bash
# è¿è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•
zig build benchmark

# è¿è¡Œé«˜æ€§èƒ½å‹åŠ›æµ‹è¯•
zig build stress-high-perf

# è¿è¡Œç½‘ç»œå‹åŠ›æµ‹è¯•
zig build stress-network

# è¿è¡Œæ‰€æœ‰å‹åŠ›æµ‹è¯•
zig build stress-all
```

### è¿è¡Œæµ‹è¯•
```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
zig build test

# è¿è¡Œé›†æˆæµ‹è¯•
zig build test-integration

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
zig build test-all
```

## ğŸ›£ è·¯çº¿å›¾

### å½“å‰çŠ¶æ€ (v0.1.0)
- âœ… æ ¸å¿ƒè¿è¡Œæ—¶æ¶æ„
- âœ… åŸºæœ¬FutureæŠ½è±¡
- âœ… å·¥ä½œçªƒå–è°ƒåº¦å™¨
- âœ… å¹³å°ç‰¹å®šI/Oé©±åŠ¨
- âœ… å†…å­˜ç®¡ç†ç³»ç»Ÿ
- âœ… ç»¼åˆåŸºå‡†æµ‹è¯•

### è¿‘æœŸç›®æ ‡ (v0.2.0)
- ğŸ”„ é«˜çº§å¼‚æ­¥ç»„åˆå­
- ğŸ”„ åˆ†å¸ƒå¼è¿½è¸ªæ”¯æŒ
- ğŸ”„ å¢å¼ºé”™è¯¯å¤„ç†
- ğŸ”„ æ›´å¤šç½‘ç»œåè®®
- ğŸ”„ æ–‡ä»¶ç³»ç»Ÿæ“ä½œ

### ä¸­æœŸç›®æ ‡ (v0.3.0)
- ğŸ“‹ Actoræ¨¡å‹æ”¯æŒ
- ğŸ“‹ å¼‚æ­¥æµ
- ğŸ“‹ WebSocketæ”¯æŒ
- ğŸ“‹ HTTP/2å’ŒHTTP/3
- ğŸ“‹ æ•°æ®åº“é©±åŠ¨

### é•¿æœŸç›®æ ‡ (v1.0.0)
- ğŸ“‹ ç¨³å®šAPI
- ğŸ“‹ ç”Ÿäº§å°±ç»ª
- ğŸ“‹ ç”Ÿæ€ç³»ç»Ÿé›†æˆ
- ğŸ“‹ æ€§èƒ½ä¼˜åŒ–
- ğŸ“‹ å…¨é¢æ–‡æ¡£

## ğŸ¤ è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿è´¡çŒ®ï¼è¯·æŸ¥çœ‹æˆ‘ä»¬çš„[è´¡çŒ®æŒ‡å—](CONTRIBUTING.md)äº†è§£è¯¦æƒ…ã€‚

### å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# å…‹éš†ä»“åº“
git clone https://github.com/louloulin/zokio.git
cd zokio

# è¿è¡Œæµ‹è¯•
zig build test-all

# è¿è¡ŒåŸºå‡†æµ‹è¯•
zig build benchmark

# æ ¼å¼åŒ–ä»£ç 
zig build fmt
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - è¯¦æƒ…è¯·æŸ¥çœ‹[LICENSE](LICENSE)æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- å—[Tokio](https://tokio.rs/)å¯å‘ - Rustçš„å¼‚æ­¥è¿è¡Œæ—¶
- ä½¿ç”¨[Zig](https://ziglang.org/)æ„å»º - é€šç”¨ç¼–ç¨‹è¯­è¨€
- ä½¿ç”¨[libxev](https://github.com/mitchellh/libxev) - é«˜æ€§èƒ½äº‹ä»¶å¾ªç¯

---

**Zokio** - é‡Šæ”¾Zigå¼‚æ­¥ç¼–ç¨‹çš„åŠ›é‡ ğŸš€
